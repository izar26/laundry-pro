import{r as c,j as e,u as V,H as Q,b as Y}from"./app-CUXBW5dx.js";import{P as ee,D as se,a as ae,b as te,d as M,A as re}from"./AdminLayout-Dj6WvTEP.js";import{D as ne}from"./data-table-c7Fdhk67.js";import{c as ie,u as $,B as y}from"./index-BvATWSjf.js";import{D as le,a as oe,b as ce,c as de,e as ue}from"./dialog-C2_qrMnw.js";import{A as me,a as pe,b as he,c as xe,e as fe,f as ge,g as je,E as ve}from"./alert-dialog-D3mrlBtR.js";import{I as v}from"./input-HL_z3B_7.js";import{L as h}from"./label-DNEfGfht.js";import{u as ye,c as _e,a as Ne}from"./index-88lnrqSU.js";import{u as Se}from"./index-rFb6iV67.js";import{u as be}from"./index-DFuNHLiv.js";import{c as P}from"./utils-BELw0PCo.js";import{S as R,a as T,b as A,c as I,d as S}from"./select-BqLD07ma.js";import{C as B}from"./calendar-DAax_im-.js";import{P as L,a as F,b as O}from"./popover-CZ-OFO0b.js";import{t as C}from"./index-B0o19xSs.js";import{B as k}from"./badge-DSYp6RDo.js";import{c as Ce}from"./createLucideIcon-uJREzNGo.js";import{P as we}from"./pencil-BsbuVYM6.js";import{T as ke}from"./trash-Bxym_lDS.js";import{C as H}from"./calendar-BUo7cYUx.js";import{f as b}from"./format-rTHyNvvs.js";import"./check-pd34nBtK.js";import"./BackgroundParticles-D888wk9C.js";import"./shirt-DHfAMZvd.js";import"./proxy-BiQenJV9.js";import"./index-Bgpi0fHY.js";const Pe=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Ee=Ce("layers",Pe);function De(s){const t=Me(s),n=c.forwardRef((i,a)=>{const{children:r,...u}=i,d=c.Children.toArray(r),m=d.find(Te);if(m){const p=m.props.children,o=d.map(x=>x===m?c.Children.count(p)>1?c.Children.only(null):c.isValidElement(p)?p.props.children:null:x);return e.jsx(t,{...u,ref:a,children:c.isValidElement(p)?c.cloneElement(p,void 0,o):null})}return e.jsx(t,{...u,ref:a,children:r})});return n.displayName=`${s}.Slot`,n}function Me(s){const t=c.forwardRef((n,i)=>{const{children:a,...r}=n;if(c.isValidElement(a)){const u=Ie(a),d=Ae(r,a.props);return a.type!==c.Fragment&&(d.ref=i?ie(i,u):u),c.cloneElement(a,d)}return c.Children.count(a)>1?c.Children.only(null):null});return t.displayName=`${s}.SlotClone`,t}var Re=Symbol("radix.slottable");function Te(s){return c.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===Re}function Ae(s,t){const n={...t};for(const i in t){const a=s[i],r=t[i];/^on[A-Z]/.test(i)?a&&r?n[i]=(...d)=>{const m=r(...d);return a(...d),m}:a&&(n[i]=a):i==="style"?n[i]={...a,...r}:i==="className"&&(n[i]=[a,r].filter(Boolean).join(" "))}return{...s,...n}}function Ie(s){let t=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?s.ref:(t=Object.getOwnPropertyDescriptor(s,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?s.props.ref:s.props.ref||s.ref)}var Be=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],K=Be.reduce((s,t)=>{const n=De(`Primitive.${t}`),i=c.forwardRef((a,r)=>{const{asChild:u,...d}=a,m=u?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(m,{...d,ref:r})});return i.displayName=`Primitive.${t}`,{...s,[t]:i}},{}),w="Switch",[Le]=_e(w),[Fe,Oe]=Le(w),z=c.forwardRef((s,t)=>{const{__scopeSwitch:n,name:i,checked:a,defaultChecked:r,required:u,disabled:d,value:m="on",onCheckedChange:p,form:o,...x}=s,[g,l]=c.useState(null),j=$(t,N=>l(N)),f=c.useRef(!1),D=g?o||!!g.closest("form"):!0,[_,Z]=ye({prop:a,defaultProp:r??!1,onChange:p,caller:w});return e.jsxs(Fe,{scope:n,checked:_,disabled:d,children:[e.jsx(K.button,{type:"button",role:"switch","aria-checked":_,"aria-required":u,"data-state":G(_),"data-disabled":d?"":void 0,disabled:d,value:m,...x,ref:j,onClick:Ne(s.onClick,N=>{Z(J=>!J),D&&(f.current=N.isPropagationStopped(),f.current||N.stopPropagation())})}),D&&e.jsx(q,{control:g,bubbles:!f.current,name:i,value:m,checked:_,required:u,disabled:d,form:o,style:{transform:"translateX(-100%)"}})]})});z.displayName=w;var U="SwitchThumb",W=c.forwardRef((s,t)=>{const{__scopeSwitch:n,...i}=s,a=Oe(U,n);return e.jsx(K.span,{"data-state":G(a.checked),"data-disabled":a.disabled?"":void 0,...i,ref:t})});W.displayName=U;var He="SwitchBubbleInput",q=c.forwardRef(({__scopeSwitch:s,control:t,checked:n,bubbles:i=!0,...a},r)=>{const u=c.useRef(null),d=$(u,r),m=Se(n),p=be(t);return c.useEffect(()=>{const o=u.current;if(!o)return;const x=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(x,"checked").set;if(m!==n&&l){const j=new Event("click",{bubbles:i});l.call(o,n),o.dispatchEvent(j)}},[m,n,i]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...a,tabIndex:-1,ref:d,style:{...a.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});q.displayName=He;function G(s){return s?"checked":"unchecked"}var X=z,Ve=W;const E=c.forwardRef(({className:s,...t},n)=>e.jsx(X,{className:P("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...t,ref:n,children:e.jsx(Ve,{className:P("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));E.displayName=X.displayName;const $e=({row:s})=>{const t=s.original,[n,i]=c.useState(!1),a=r=>{i(!0),Y.put(route("promotions.update",t.id),{...t,is_active:r,_method:"PUT"},{onSuccess:()=>{C.success(`Promo ${r?"diaktifkan":"dinonaktifkan"}.`),i(!1)},onError:()=>{C.error("Gagal mengubah status."),i(!1)},preserveState:!0,preserveScroll:!0})};return e.jsxs("div",{className:"flex items-center gap-2",onClick:r=>r.stopPropagation(),children:[e.jsx(E,{checked:t.is_active,onCheckedChange:a,disabled:n,className:"scale-75"}),e.jsx("span",{className:P("text-xs",t.is_active?"text-emerald-600 font-medium":"text-muted-foreground"),children:t.is_active?"Aktif":"Mati"})]})};function Ke({promotion:s,services:t,isOpen:n,setIsOpen:i}){const{data:a,setData:r,post:u,put:d,processing:m,errors:p,reset:o,clearErrors:x}=V({name:"",code:"",service_id:"all",type:"percentage",value:"",min_weight:"",min_amount:"",start_date:void 0,end_date:void 0,description:"",is_active:!0});c.useEffect(()=>{s?r({name:s.name,code:s.code||"",service_id:s.service_id||"all",type:s.type,value:parseFloat(s.value).toString(),min_weight:s.min_weight?parseFloat(s.min_weight).toString():"",min_amount:s.min_amount?parseFloat(s.min_amount).toString():"",start_date:s.start_date?new Date(s.start_date):void 0,end_date:s.end_date?new Date(s.end_date):void 0,description:s.description||"",is_active:s.is_active}):(o(),r("is_active",!0)),x()},[s,n]);const g=l=>{l.preventDefault();const j={...a,service_id:a.service_id==="all"?null:a.service_id,start_date:a.start_date?b(a.start_date,"yyyy-MM-dd"):null,end_date:a.end_date?b(a.end_date,"yyyy-MM-dd"):null},f={onSuccess:()=>{i(!1),o(),C.success("Promosi berhasil disimpan.")},onError:()=>C.error("Terjadi kesalahan.")};s?d(route("promotions.update",s.id),{...j,onSuccess:f.onSuccess,onError:f.onError}):u(route("promotions.store"),{...j,onSuccess:f.onSuccess,onError:f.onError})};return e.jsx(le,{open:n,onOpenChange:i,children:e.jsxs(oe,{className:"sm:max-w-[700px]",children:[e.jsx(ce,{children:e.jsx(de,{children:s?"Edit Promosi":"Buat Promosi Baru"})}),e.jsxs("form",{onSubmit:g,className:"grid grid-cols-2 gap-6 py-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(h,{htmlFor:"name",children:["Nama Promo ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(v,{id:"name",value:a.name,onChange:l=>r("name",l.target.value)}),p.name&&e.jsx("span",{className:"text-xs text-destructive",children:p.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Berlaku Untuk Layanan"}),e.jsxs(R,{value:a.service_id.toString(),onValueChange:l=>r("service_id",l==="all"?"all":parseInt(l)),children:[e.jsx(T,{children:e.jsx(A,{})}),e.jsxs(I,{children:[e.jsx(S,{value:"all",children:"Semua Layanan"}),t.map(l=>e.jsx(S,{value:l.id.toString(),children:l.name},l.id))]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{htmlFor:"code",children:"Kode Voucher (Opsional)"}),e.jsx(v,{id:"code",placeholder:"KODE",value:a.code,onChange:l=>r("code",l.target.value.toUpperCase()),className:"uppercase font-mono"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Tipe"}),e.jsxs(R,{value:a.type,onValueChange:l=>r("type",l),children:[e.jsx(T,{children:e.jsx(A,{})}),e.jsxs(I,{children:[e.jsx(S,{value:"percentage",children:"Persentase (%)"}),e.jsx(S,{value:"fixed",children:"Nominal (Rp)"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Nilai"}),e.jsx(v,{type:"number",value:a.value,onChange:l=>r("value",l.target.value)})]})]})]}),e.jsxs("div",{className:"space-y-4 border-l pl-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Min. Berat (Kg)"}),e.jsx(v,{type:"number",value:a.min_weight,onChange:l=>r("min_weight",l.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Min. Transaksi (Rp)"}),e.jsx(v,{type:"number",value:a.min_amount,onChange:l=>r("min_amount",l.target.value)})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Periode"}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(L,{children:[e.jsx(F,{asChild:!0,children:e.jsxs(y,{variant:"outline",className:"justify-start font-normal",children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),a.start_date?b(a.start_date,"dd MMM yyyy"):"Mulai"]})}),e.jsx(O,{className:"w-auto p-0",children:e.jsx(B,{mode:"single",selected:a.start_date,onSelect:l=>r("start_date",l)})})]}),e.jsxs(L,{children:[e.jsx(F,{asChild:!0,children:e.jsxs(y,{variant:"outline",className:"justify-start font-normal",children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),a.end_date?b(a.end_date,"dd MMM yyyy"):"Selesai"]})}),e.jsx(O,{className:"w-auto p-0",children:e.jsx(B,{mode:"single",selected:a.end_date,onSelect:l=>r("end_date",l)})})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(E,{checked:a.is_active,onCheckedChange:l=>r("is_active",l)}),e.jsx(h,{children:"Status Aktif"})]})]}),e.jsx(ue,{className:"col-span-2 pt-4 border-t",children:e.jsx(y,{type:"submit",disabled:m,children:s?"Simpan":"Buat"})})]})]})})}function ze({promotions:s,services:t}){const[n,i]=c.useState(!1),[a,r]=c.useState(null),[u,d]=c.useState(null),{delete:m}=V({}),p=[{accessorKey:"name",header:"Nama Promosi",cell:({row:o})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:o.getValue("name")}),e.jsxs("div",{className:"flex gap-1 mt-1",children:[o.original.code&&e.jsxs(k,{variant:"outline",className:"text-[10px] font-mono",children:["CODE: ",o.original.code]}),o.original.service?e.jsxs(k,{variant:"secondary",className:"text-[10px]",children:[e.jsx(Ee,{className:"w-2 h-2 mr-1"})," ",o.original.service.name]}):e.jsx(k,{variant:"outline",className:"text-[10px]",children:"Semua Layanan"})]})]})},{accessorKey:"value",header:"Diskon",cell:({row:o})=>e.jsx("div",{className:"font-bold text-emerald-600",children:o.original.type==="percentage"?`${parseFloat(o.original.value)}%`:`Rp${parseFloat(o.original.value).toLocaleString()}`})},{accessorKey:"is_active",header:"Status",cell:({row:o})=>e.jsx($e,{row:o})},{id:"actions",cell:({row:o})=>e.jsx("div",{className:"flex justify-end",children:e.jsxs(se,{children:[e.jsx(ae,{asChild:!0,children:e.jsx(y,{variant:"ghost",size:"sm",children:e.jsx(ve,{className:"h-4 w-4"})})}),e.jsxs(te,{align:"end",children:[e.jsxs(M,{onClick:()=>{r(o.original),i(!0)},children:[e.jsx(we,{className:"mr-2 h-4 w-4"})," Edit"]}),e.jsxs(M,{onClick:()=>d(o.original.id),className:"text-destructive",children:[e.jsx(ke,{className:"mr-2 h-4 w-4"})," Hapus"]})]})]})})}];return e.jsxs(e.Fragment,{children:[e.jsx(Q,{title:"Manajemen Promosi"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Promosi"}),e.jsx("p",{className:"text-muted-foreground",children:"Kelola diskon layanan laundry."})]}),e.jsxs(y,{onClick:()=>{r(null),i(!0)},size:"lg",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"})," Buat Promo"]})]}),e.jsx("div",{className:"mt-8",children:e.jsx(ne,{columns:p,data:s.data,pagination:s,searchKey:"name"})}),e.jsx(Ke,{isOpen:n,setIsOpen:i,promotion:a,services:t}),e.jsx(me,{open:!!u,onOpenChange:o=>!o&&d(null),children:e.jsxs(pe,{children:[e.jsx(he,{children:e.jsx(xe,{children:"Hapus?"})}),e.jsxs(fe,{children:[e.jsx(ge,{children:"Batal"}),e.jsx(je,{onClick:()=>m(route("promotions.destroy",u||0),{onSuccess:()=>d(null)}),className:"bg-destructive",children:"Hapus"})]})]})})]})}ze.layout=s=>e.jsx(re,{children:s});export{ze as default};

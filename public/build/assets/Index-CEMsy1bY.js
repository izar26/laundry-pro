import{u as F,r as g,a as A,j as a,H as T}from"./app-BJUS283V.js";import{P as B,D as I,a as M,b as H,d as D,A as O}from"./AdminLayout-BVeV9NOV.js";import{D as S}from"./data-table-CoXa6ch6.js";import{B as j}from"./button-Cknn52O-.js";import{D as L,a as K,b as U,c as G,d as Y,e as $}from"./dialog-D6sxQ6X3.js";import{A as z,a as J,b as R,c as _,d as q,e as Q,f as V,g as W,E as X}from"./alert-dialog-B6KqeVnj.js";import{I as x}from"./input-DGvHYAy_.js";import{L as m}from"./label-CfrMJ7yu.js";import{T as Z}from"./textarea-BC1I0niA.js";import{U as aa,t as f}from"./index-DvSpuR_m.js";import{A as ea,a as sa,b as ra}from"./avatar-XEMO5tCm.js";import{B as k}from"./badge-kINtg_Iu.js";import{L as ia}from"./loader-circle-H5mEidIU.js";import{P as ta}from"./pencil-DYUwNYHG.js";import{T as na}from"./trash-BcYkvIBz.js";import"./utils-BELw0PCo.js";import"./index-2G1qpvYq.js";import"./index-DGFwUscm.js";import"./index-GU3xWpFW.js";import"./index-DUpLxr6b.js";import"./createLucideIcon-Bimzm9Cs.js";import"./check-BjYZDW6K.js";import"./BackgroundParticles-Dk0cbptV.js";import"./shirt-ZtxoH7MD.js";import"./proxy-JpFdu96N.js";import"./index-DJhWr_N3.js";import"./index-PZITClZQ.js";function la({employee:e,isOpen:p,setIsOpen:n}){const{data:l,setData:t,post:v,put:d,processing:u,errors:i,reset:o,clearErrors:c}=A({name:"",email:"",password:"",phone:"",address:""});g.useEffect(()=>{e?t({name:e.user.name,email:e.user.email,password:"",phone:e.phone||"",address:e.address||""}):o(),c()},[e,p]);const w=r=>{r.preventDefault();const h={onSuccess:()=>{n(!1),o(),f.success(e?"Data pegawai diperbarui.":"Pegawai baru ditambahkan.")},onError:()=>{f.error("Gagal menyimpan data pegawai.")}};e?d(route("employees.update",e.id),h):v(route("employees.store"),h)};return a.jsx(L,{open:p,onOpenChange:n,children:a.jsxs(K,{className:"sm:max-w-[500px]",children:[a.jsxs(U,{children:[a.jsx(G,{children:e?"Edit Data Pegawai":"Tambah Pegawai Baru"}),a.jsx(Y,{children:'Pegawai baru akan otomatis mendapatkan role "Pegawai" dan bisa login ke sistem.'})]}),a.jsxs("form",{onSubmit:w,className:"grid gap-4 py-2",children:[a.jsxs("div",{className:"grid gap-2",children:[a.jsxs(m,{htmlFor:"name",children:["Nama Lengkap ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(x,{id:"name",placeholder:"Nama Pegawai",value:l.name,onChange:r=>t("name",r.target.value),className:i.name?"border-destructive":""}),i.name&&a.jsx("span",{className:"text-xs text-destructive",children:i.name})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsxs(m,{htmlFor:"email",children:["Email Login ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(x,{id:"email",type:"email",placeholder:"pegawai@laundry.test",value:l.email,onChange:r=>t("email",r.target.value),className:i.email?"border-destructive":""}),i.email&&a.jsx("span",{className:"text-xs text-destructive",children:i.email})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsx(m,{htmlFor:"phone",children:"Nomor HP"}),a.jsx(x,{id:"phone",placeholder:"0812xxxx",value:l.phone,onChange:r=>t("phone",r.target.value)})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsx(m,{htmlFor:"address",children:"Alamat"}),a.jsx(Z,{id:"address",placeholder:"Jl. Alamat Pegawai...",value:l.address,onChange:r=>t("address",r.target.value)})]}),a.jsxs("div",{className:"grid gap-2",children:[a.jsxs(m,{htmlFor:"password",children:[e?"Password Baru (Opsional)":"Password"," ",e?"":a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(x,{id:"password",type:"password",placeholder:e?"Biarkan kosong jika tidak ingin mengubah":"Minimal 8 karakter",value:l.password,onChange:r=>t("password",r.target.value),className:i.password?"border-destructive":""}),e&&a.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Isi hanya jika ingin mereset password pegawai ini."}),i.password&&a.jsx("span",{className:"text-xs text-destructive",children:i.password})]}),a.jsxs($,{className:"mt-4",children:[a.jsx(j,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Batal"}),a.jsxs(j,{type:"submit",disabled:u,children:[u&&a.jsx(ia,{className:"mr-2 h-4 w-4 animate-spin"}),e?"Simpan Perubahan":"Tambah Pegawai"]})]})]})]})})}function oa({employees:e}){const{auth:p}=F().props,n=p.user,t=!n.roles?.includes("owner"),[v,d]=g.useState(!1),[u,i]=g.useState(null),[o,c]=g.useState(null),{delete:w,processing:r}=A({}),h=()=>{i(null),d(!0)},P=s=>{i(s),d(!0)},C=s=>{c(s)},E=()=>{o&&w(route("employees.destroy",o),{onSuccess:()=>{c(null),f.success("Akun pegawai dihapus.")},onError:()=>f.error("Gagal menghapus akun.")})},b=[{accessorKey:"user.name",header:"Nama Pegawai",cell:({row:s})=>a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(ea,{className:"h-8 w-8",children:[a.jsx(sa,{src:s.original.user.avatar?`/storage/${s.original.user.avatar}`:`https://ui-avatars.com/api/?name=${s.original.user.name}&background=random`}),a.jsx(ra,{children:a.jsx(aa,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium",children:s.original.user.name}),s.original.position==="Owner"&&a.jsx(k,{variant:"default",className:"h-5 px-1.5 text-[10px] bg-purple-600 hover:bg-purple-700",children:"Owner"}),s.original.position==="Administrator"&&a.jsx(k,{variant:"default",className:"h-5 px-1.5 text-[10px] bg-blue-600 hover:bg-blue-700",children:"Admin"})]}),s.original.user.id===n.id&&a.jsx("span",{className:"text-[10px] text-muted-foreground",children:"It's You"})]})]})},{accessorKey:"user.email",header:"Email"}];return t&&b.push({id:"actions",cell:({row:s})=>{const N=s.original,y=N.user.id===n.id;return a.jsx("div",{className:"flex justify-end",children:a.jsxs(I,{children:[a.jsx(M,{asChild:!0,children:a.jsx(j,{variant:"ghost",className:"h-8 w-8 p-0",children:a.jsx(X,{className:"h-4 w-4"})})}),a.jsxs(H,{align:"end",children:[a.jsxs(D,{onClick:()=>P(N),children:[a.jsx(ta,{className:"mr-2 h-4 w-4"})," Edit Data"]}),a.jsxs(D,{onClick:()=>C(N.id),className:"text-destructive",disabled:y,children:[a.jsx(na,{className:"mr-2 h-4 w-4"})," Hapus Akun"]})]})]})})}}),a.jsxs(a.Fragment,{children:[a.jsx(T,{title:"Manajemen Pegawai"}),a.jsxs("div",{className:"flex items-center justify-between space-y-2",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Data Pegawai"}),a.jsx("p",{className:"text-muted-foreground",children:"Kelola akun staf yang memiliki akses ke sistem."})]}),t&&a.jsxs(j,{onClick:h,size:"lg",children:[a.jsx(B,{className:"mr-2 h-4 w-4"})," Tambah Pegawai"]})]}),a.jsx("div",{className:"mt-8",children:a.jsx(S,{columns:b,data:e.data,pagination:e,searchKey:"name"})}),t&&a.jsxs(a.Fragment,{children:[a.jsx(la,{isOpen:v,setIsOpen:d,employee:u}),a.jsx(z,{open:!!o,onOpenChange:s=>!s&&c(null),children:a.jsxs(J,{children:[a.jsxs(R,{children:[a.jsx(_,{children:"Hapus Akun Pegawai?"}),a.jsx(q,{children:"Akses login pegawai ini akan dicabut permanen. Data transaksi yang pernah dibuat oleh pegawai ini tetap aman."})]}),a.jsxs(Q,{children:[a.jsx(V,{disabled:r,children:"Batal"}),a.jsx(W,{onClick:s=>{s.preventDefault(),E()},disabled:r,className:"bg-destructive hover:bg-destructive/90",children:r?"Menghapus...":"Ya, Hapus"})]})]})})]})]})}oa.layout=e=>a.jsx(O,{children:e});export{oa as default};

import{r as o,j as e,a as V,H as Q,b as Y}from"./app-Clij37a7.js";import{P as ee,D as se,a as ae,b as te,d as M,A as re}from"./AdminLayout-DcDEw9F0.js";import{D as ne}from"./data-table-Dk_fcylh.js";import{c as ie,u as $,B as y}from"./button-Du4d_PUj.js";import{D as le,a as oe,b as ce,c as de,e as ue}from"./dialog-DmKU8xAV.js";import{A as me,a as pe,b as he,c as xe,e as fe,f as ge,g as je,E as ve}from"./alert-dialog-DysXxPJg.js";import{I as v}from"./input-B7nGYMVS.js";import{L as x}from"./label-BxHtQkO_.js";import{u as ye,c as _e,a as Ne}from"./index-BbA6YFUE.js";import{u as Se}from"./index-C4ax3cPY.js";import{u as be}from"./index-DG6IDE4v.js";import{c as P}from"./utils-BELw0PCo.js";import{S as R,a as T,b as A,c as I,d as S}from"./select-CQlyEsEW.js";import{C as B}from"./calendar-D-CInuBZ.js";import{P as F,a as L,b as O}from"./popover-Cc0xyugX.js";import{t as C}from"./index-mAcSEs5T.js";import{B as k}from"./badge-IaJrgpel.js";import{c as Ce}from"./createLucideIcon-7pP0XTvI.js";import{C as H}from"./calendar-Bud6DQHR.js";import{P as we}from"./pencil-kqfN564Q.js";import{T as ke}from"./trash-ZFUkII0b.js";import{f as b}from"./format-rTHyNvvs.js";import"./index-fKL662UW.js";import"./index-D44yVRzP.js";import"./check-f6-8tjn4.js";import"./avatar-R8uWMimD.js";import"./index-zwkoN8Zf.js";import"./BackgroundParticles-CVKq8XbX.js";import"./shirt-CIX-2J_S.js";import"./proxy-BgYb6SAi.js";import"./index-rYS_I75V.js";const Pe=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Ee=Ce("layers",Pe);function De(s){const r=Me(s),t=o.forwardRef((i,a)=>{const{children:n,...d}=i,u=o.Children.toArray(n),m=u.find(Te);if(m){const p=m.props.children,h=u.map(c=>c===m?o.Children.count(p)>1?o.Children.only(null):o.isValidElement(p)?p.props.children:null:c);return e.jsx(r,{...d,ref:a,children:o.isValidElement(p)?o.cloneElement(p,void 0,h):null})}return e.jsx(r,{...d,ref:a,children:n})});return t.displayName=`${s}.Slot`,t}function Me(s){const r=o.forwardRef((t,i)=>{const{children:a,...n}=t;if(o.isValidElement(a)){const d=Ie(a),u=Ae(n,a.props);return a.type!==o.Fragment&&(u.ref=i?ie(i,d):d),o.cloneElement(a,u)}return o.Children.count(a)>1?o.Children.only(null):null});return r.displayName=`${s}.SlotClone`,r}var Re=Symbol("radix.slottable");function Te(s){return o.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===Re}function Ae(s,r){const t={...r};for(const i in r){const a=s[i],n=r[i];/^on[A-Z]/.test(i)?a&&n?t[i]=(...u)=>{const m=n(...u);return a(...u),m}:a&&(t[i]=a):i==="style"?t[i]={...a,...n}:i==="className"&&(t[i]=[a,n].filter(Boolean).join(" "))}return{...s,...t}}function Ie(s){let r=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?s.ref:(r=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}var Be=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],K=Be.reduce((s,r)=>{const t=De(`Primitive.${r}`),i=o.forwardRef((a,n)=>{const{asChild:d,...u}=a,m=d?t:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(m,{...u,ref:n})});return i.displayName=`Primitive.${r}`,{...s,[r]:i}},{}),w="Switch",[Fe]=_e(w),[Le,Oe]=Fe(w),z=o.forwardRef((s,r)=>{const{__scopeSwitch:t,name:i,checked:a,defaultChecked:n,required:d,disabled:u,value:m="on",onCheckedChange:p,form:h,...c}=s,[g,l]=o.useState(null),j=$(r,N=>l(N)),f=o.useRef(!1),D=g?h||!!g.closest("form"):!0,[_,Z]=ye({prop:a,defaultProp:n??!1,onChange:p,caller:w});return e.jsxs(Le,{scope:t,checked:_,disabled:u,children:[e.jsx(K.button,{type:"button",role:"switch","aria-checked":_,"aria-required":d,"data-state":G(_),"data-disabled":u?"":void 0,disabled:u,value:m,...c,ref:j,onClick:Ne(s.onClick,N=>{Z(J=>!J),D&&(f.current=N.isPropagationStopped(),f.current||N.stopPropagation())})}),D&&e.jsx(q,{control:g,bubbles:!f.current,name:i,value:m,checked:_,required:d,disabled:u,form:h,style:{transform:"translateX(-100%)"}})]})});z.displayName=w;var U="SwitchThumb",W=o.forwardRef((s,r)=>{const{__scopeSwitch:t,...i}=s,a=Oe(U,t);return e.jsx(K.span,{"data-state":G(a.checked),"data-disabled":a.disabled?"":void 0,...i,ref:r})});W.displayName=U;var He="SwitchBubbleInput",q=o.forwardRef(({__scopeSwitch:s,control:r,checked:t,bubbles:i=!0,...a},n)=>{const d=o.useRef(null),u=$(d,n),m=Se(t),p=be(r);return o.useEffect(()=>{const h=d.current;if(!h)return;const c=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(c,"checked").set;if(m!==t&&l){const j=new Event("click",{bubbles:i});l.call(h,t),h.dispatchEvent(j)}},[m,t,i]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...a,tabIndex:-1,ref:u,style:{...a.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});q.displayName=He;function G(s){return s?"checked":"unchecked"}var X=z,Ve=W;const E=o.forwardRef(({className:s,...r},t)=>e.jsx(X,{className:P("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...r,ref:t,children:e.jsx(Ve,{className:P("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));E.displayName=X.displayName;const $e=({row:s,canManage:r})=>{const t=s.original,[i,a]=o.useState(!1),n=d=>{r&&(a(!0),Y.put(route("promotions.update",t.id),{...t,is_active:d,_method:"PUT"},{onSuccess:()=>{C.success(`Promo ${d?"diaktifkan":"dinonaktifkan"}.`),a(!1)},onError:()=>{C.error("Gagal mengubah status."),a(!1)},preserveState:!0,preserveScroll:!0}))};return e.jsxs("div",{className:"flex items-center gap-2",onClick:d=>d.stopPropagation(),children:[e.jsx(E,{checked:t.is_active,onCheckedChange:n,disabled:i||!r,className:"scale-75"}),e.jsx("span",{className:P("text-xs",t.is_active?"text-emerald-600 font-medium":"text-muted-foreground"),children:t.is_active?"Aktif":"Mati"})]})};function Ke({promotion:s,services:r,isOpen:t,setIsOpen:i}){const{data:a,setData:n,post:d,put:u,processing:m,errors:p,reset:h,clearErrors:c}=V({name:"",code:"",service_id:"all",type:"percentage",value:"",min_weight:"",min_amount:"",start_date:void 0,end_date:void 0,description:"",is_active:!0});o.useEffect(()=>{s?n({name:s.name,code:s.code||"",service_id:s.service_id||"all",type:s.type,value:parseFloat(s.value).toString(),min_weight:s.min_weight?parseFloat(s.min_weight).toString():"",min_amount:s.min_amount?parseFloat(s.min_amount).toString():"",start_date:s.start_date?new Date(s.start_date):void 0,end_date:s.end_date?new Date(s.end_date):void 0,description:s.description||"",is_active:s.is_active}):(h(),n("is_active",!0)),c()},[s,t]);const g=l=>{l.preventDefault();const j={...a,service_id:a.service_id==="all"?null:a.service_id,start_date:a.start_date?b(a.start_date,"yyyy-MM-dd"):null,end_date:a.end_date?b(a.end_date,"yyyy-MM-dd"):null},f={onSuccess:()=>{i(!1),h(),C.success("Promosi berhasil disimpan.")},onError:()=>C.error("Terjadi kesalahan.")};s?u(route("promotions.update",s.id),{...j,onSuccess:f.onSuccess,onError:f.onError}):d(route("promotions.store"),{...j,onSuccess:f.onSuccess,onError:f.onError})};return e.jsx(le,{open:t,onOpenChange:i,children:e.jsxs(oe,{className:"sm:max-w-[700px]",children:[e.jsx(ce,{children:e.jsx(de,{children:s?"Edit Promosi":"Buat Promosi Baru"})}),e.jsxs("form",{onSubmit:g,className:"grid grid-cols-2 gap-6 py-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(x,{htmlFor:"name",children:["Nama Promo ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(v,{id:"name",value:a.name,onChange:l=>n("name",l.target.value)}),p.name&&e.jsx("span",{className:"text-xs text-destructive",children:p.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{children:"Berlaku Untuk Layanan"}),e.jsxs(R,{value:a.service_id.toString(),onValueChange:l=>n("service_id",l==="all"?"all":parseInt(l)),children:[e.jsx(T,{children:e.jsx(A,{})}),e.jsxs(I,{children:[e.jsx(S,{value:"all",children:"Semua Layanan"}),r.map(l=>e.jsx(S,{value:l.id.toString(),children:l.name},l.id))]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{htmlFor:"code",children:"Kode Voucher (Opsional)"}),e.jsx(v,{id:"code",placeholder:"KODE",value:a.code,onChange:l=>n("code",l.target.value.toUpperCase()),className:"uppercase font-mono"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{children:"Tipe"}),e.jsxs(R,{value:a.type,onValueChange:l=>n("type",l),children:[e.jsx(T,{children:e.jsx(A,{})}),e.jsxs(I,{children:[e.jsx(S,{value:"percentage",children:"Persentase (%)"}),e.jsx(S,{value:"fixed",children:"Nominal (Rp)"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{children:"Nilai"}),e.jsx(v,{type:"number",value:a.value,onChange:l=>n("value",l.target.value)})]})]})]}),e.jsxs("div",{className:"space-y-4 border-l pl-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{children:"Min. Berat (Kg)"}),e.jsx(v,{type:"number",value:a.min_weight,onChange:l=>n("min_weight",l.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{children:"Min. Transaksi (Rp)"}),e.jsx(v,{type:"number",value:a.min_amount,onChange:l=>n("min_amount",l.target.value)})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(x,{children:"Periode"}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(F,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(y,{variant:"outline",className:"justify-start font-normal",children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),a.start_date?b(a.start_date,"dd MMM yyyy"):"Mulai"]})}),e.jsx(O,{className:"w-auto p-0",children:e.jsx(B,{mode:"single",selected:a.start_date,onSelect:l=>n("start_date",l)})})]}),e.jsxs(F,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(y,{variant:"outline",className:"justify-start font-normal",children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),a.end_date?b(a.end_date,"dd MMM yyyy"):"Selesai"]})}),e.jsx(O,{className:"w-auto p-0",children:e.jsx(B,{mode:"single",selected:a.end_date,onSelect:l=>n("end_date",l)})})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(E,{checked:a.is_active,onCheckedChange:l=>n("is_active",l)}),e.jsx(x,{children:"Status Aktif"})]})]}),e.jsx(ue,{className:"col-span-2 pt-4 border-t",children:e.jsx(y,{type:"submit",disabled:m,children:s?"Simpan":"Buat"})})]})]})})}function ze({promotions:s,services:r,canManagePromotions:t=!1}){const[i,a]=o.useState(!1),[n,d]=o.useState(null),[u,m]=o.useState(null),{delete:p}=V({}),h=[{accessorKey:"name",header:"Nama Promosi",cell:({row:c})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:c.getValue("name")}),e.jsxs("div",{className:"flex gap-1 mt-1",children:[c.original.code&&e.jsxs(k,{variant:"outline",className:"text-[10px] font-mono",children:["CODE: ",c.original.code]}),c.original.service?e.jsxs(k,{variant:"secondary",className:"text-[10px]",children:[e.jsx(Ee,{className:"w-2 h-2 mr-1"})," ",c.original.service.name]}):e.jsx(k,{variant:"outline",className:"text-[10px]",children:"Semua Layanan"})]})]})},{accessorKey:"value",header:"Diskon",cell:({row:c})=>e.jsx("div",{className:"font-bold text-emerald-600",children:c.original.type==="percentage"?`${parseFloat(c.original.value)}%`:`Rp${parseFloat(c.original.value).toLocaleString()}`})},{accessorKey:"is_active",header:"Status",cell:({row:c})=>e.jsx($e,{row:c,canManage:t})}];return t&&h.push({id:"actions",cell:({row:c})=>e.jsx("div",{className:"flex justify-end",children:e.jsxs(se,{children:[e.jsx(ae,{asChild:!0,children:e.jsx(y,{variant:"ghost",size:"sm",children:e.jsx(ve,{className:"h-4 w-4"})})}),e.jsxs(te,{align:"end",children:[e.jsxs(M,{onClick:()=>{d(c.original),a(!0)},children:[e.jsx(we,{className:"mr-2 h-4 w-4"})," Edit"]}),e.jsxs(M,{onClick:()=>m(c.original.id),className:"text-destructive",children:[e.jsx(ke,{className:"mr-2 h-4 w-4"})," Hapus"]})]})]})})}),e.jsxs(e.Fragment,{children:[e.jsx(Q,{title:"Manajemen Promosi"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Promosi"}),e.jsx("p",{className:"text-muted-foreground",children:"Kelola diskon layanan laundry."})]}),t&&e.jsxs(y,{onClick:()=>{d(null),a(!0)},size:"lg",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"})," Buat Promo"]})]}),e.jsx("div",{className:"mt-8",children:e.jsx(ne,{columns:h,data:s.data,pagination:s,searchKey:"name"})}),t&&e.jsxs(e.Fragment,{children:[e.jsx(Ke,{isOpen:i,setIsOpen:a,promotion:n,services:r}),e.jsx(me,{open:!!u,onOpenChange:c=>!c&&m(null),children:e.jsxs(pe,{children:[e.jsx(he,{children:e.jsx(xe,{children:"Hapus?"})}),e.jsxs(fe,{children:[e.jsx(ge,{children:"Batal"}),e.jsx(je,{onClick:()=>p(route("promotions.destroy",u||0),{onSuccess:()=>m(null)}),className:"bg-destructive",children:"Hapus"})]})]})})]})]})}ze.layout=s=>e.jsx(re,{children:s});export{ze as default};

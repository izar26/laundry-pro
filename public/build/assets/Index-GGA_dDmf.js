import{r as u,u as C,j as e,H as w}from"./app-CUXBW5dx.js";import{P as y,D as P,a as E,b as T,c as F,d as b,A as M}from"./AdminLayout-Dj6WvTEP.js";import{D as S}from"./data-table-c7Fdhk67.js";import{B as j}from"./index-BvATWSjf.js";import{D as L,a as H,b as K,c as B,d as I,e as O}from"./dialog-C2_qrMnw.js";import{A as V,a as z,b as G,c as J,d as R,e as U,f as W,g as Y,E as _}from"./alert-dialog-D3mrlBtR.js";import{I as v}from"./input-HL_z3B_7.js";import{L as g}from"./label-DNEfGfht.js";import{T as q}from"./textarea-KiGVKAuK.js";import{t as f}from"./index-B0o19xSs.js";import{L as A}from"./loader-circle-CiGR35HH.js";import{T as k}from"./trash-Bxym_lDS.js";import{P as Q}from"./pencil-BsbuVYM6.js";import"./utils-BELw0PCo.js";import"./index-88lnrqSU.js";import"./index-DFuNHLiv.js";import"./createLucideIcon-uJREzNGo.js";import"./check-pd34nBtK.js";import"./BackgroundParticles-D888wk9C.js";import"./shirt-DHfAMZvd.js";import"./proxy-BiQenJV9.js";import"./index-Bgpi0fHY.js";function X({customer:a,isOpen:m,setIsOpen:t}){const{data:i,setData:l,post:o,put:d,processing:p,errors:n,reset:h,clearErrors:D}=C({name:"",phone:"",email:"",address:""});u.useEffect(()=>{a?l({name:a.name,phone:a.phone,email:a.email||"",address:a.address||""}):h(),D()},[a,m]);const N=r=>{r.preventDefault();const x={onSuccess:()=>{t(!1),h(),f.success(a?"Data pelanggan berhasil diperbarui.":"Pelanggan baru berhasil ditambahkan.")},onError:()=>{f.error("Terjadi kesalahan. Periksa input Anda.")}};a?d(route("customers.update",a.id),x):o(route("customers.store"),x)};return e.jsx(L,{open:m,onOpenChange:t,children:e.jsxs(H,{className:"sm:max-w-[500px]",children:[e.jsxs(K,{children:[e.jsx(B,{children:a?"Edit Data Pelanggan":"Tambah Pelanggan Baru"}),e.jsx(I,{children:a?"Ubah informasi pelanggan di bawah ini.":"Masukkan informasi pelanggan baru untuk database."})]}),e.jsxs("form",{onSubmit:N,className:"grid gap-4 py-2",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(g,{htmlFor:"name",children:["Nama Lengkap ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(v,{id:"name",placeholder:"Contoh: Budi Santoso",value:i.name,onChange:r=>l("name",r.target.value),className:n.name?"border-destructive":"",autoFocus:!0}),n.name&&e.jsx("span",{className:"text-xs text-destructive",children:n.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(g,{htmlFor:"phone",children:["No. HP / WhatsApp ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(v,{id:"phone",placeholder:"0812...",value:i.phone,onChange:r=>l("phone",r.target.value),className:n.phone?"border-destructive":""}),n.phone&&e.jsx("span",{className:"text-xs text-destructive",children:n.phone})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"email",children:"Email (Opsional)"}),e.jsx(v,{id:"email",type:"email",placeholder:"budi@example.com",value:i.email,onChange:r=>l("email",r.target.value)}),n.email&&e.jsx("span",{className:"text-xs text-destructive",children:n.email})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"address",children:"Alamat Lengkap"}),e.jsx(q,{id:"address",placeholder:"Jl. Mawar No. 12, Kel. Melati...",value:i.address,onChange:r=>l("address",r.target.value),className:"resize-none",rows:3})]}),e.jsxs(O,{className:"mt-4",children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Batal"}),e.jsxs(j,{type:"submit",disabled:p,children:[p&&e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),a?"Simpan Perubahan":"Simpan Pelanggan"]})]})]})]})})}function Z({customers:a}){const[m,t]=u.useState(!1),[i,l]=u.useState(null),[o,d]=u.useState(null),{delete:p,processing:n}=C({}),h=()=>{l(null),t(!0)},D=s=>{l(s),t(!0)},N=s=>{d(s)},r=()=>{o&&p(route("customers.destroy",o),{onSuccess:()=>{d(null),f.success("Pelanggan berhasil dihapus dari database.")},onError:()=>{f.error("Gagal menghapus pelanggan.")}})},x=[{accessorKey:"name",header:"Nama Pelanggan",cell:({row:s})=>e.jsx("div",{className:"font-medium",children:s.getValue("name")})},{accessorKey:"phone",header:"Kontak",cell:({row:s})=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:s.getValue("phone")}),s.original.email&&e.jsx("span",{className:"text-xs text-muted-foreground",children:s.original.email})]})},{accessorKey:"address",header:"Alamat",cell:({row:s})=>{const c=s.getValue("address");return e.jsx("div",{className:"max-w-[250px] truncate text-muted-foreground",title:c||"",children:c||"-"})}},{id:"actions",cell:({row:s})=>{const c=s.original;return e.jsx("div",{className:"flex justify-end",children:e.jsxs(P,{children:[e.jsx(E,{asChild:!0,children:e.jsxs(j,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(_,{className:"h-4 w-4"})]})}),e.jsxs(T,{align:"end",children:[e.jsx(F,{children:"Aksi"}),e.jsxs(b,{onClick:()=>D(c),children:[e.jsx(Q,{className:"mr-2 h-4 w-4"})," Edit Data"]}),e.jsxs(b,{onClick:()=>N(c.id),className:"text-destructive focus:text-destructive",children:[e.jsx(k,{className:"mr-2 h-4 w-4"})," Hapus"]})]})]})})}}];return e.jsxs(e.Fragment,{children:[e.jsx(w,{title:"Manajemen Pelanggan"}),e.jsxs("div",{className:"flex items-center justify-between space-y-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Data Pelanggan"}),e.jsx("p",{className:"text-muted-foreground",children:"Kelola data pelanggan dan riwayat informasi kontak mereka."})]}),e.jsxs(j,{onClick:h,size:"lg",children:[e.jsx(y,{className:"mr-2 h-4 w-4"})," Tambah Pelanggan"]})]}),e.jsx("div",{className:"mt-8",children:e.jsx(S,{columns:x,data:a.data,pagination:a,searchKey:"name"})}),e.jsx(X,{isOpen:m,setIsOpen:t,customer:i}),e.jsx(V,{open:!!o,onOpenChange:s=>!s&&d(null),children:e.jsxs(z,{children:[e.jsxs(G,{children:[e.jsx(J,{children:"Apakah Anda yakin?"}),e.jsx(R,{children:"Tindakan ini tidak dapat dibatalkan. Data pelanggan ini akan dihapus permanen dari server."})]}),e.jsxs(U,{children:[e.jsx(W,{disabled:n,children:"Batal"}),e.jsxs(Y,{onClick:s=>{s.preventDefault(),r()},disabled:n,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[n?e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(k,{className:"mr-2 h-4 w-4"}),n?"Menghapus...":"Ya, Hapus"]})]})]})})]})}Z.layout=a=>e.jsx(M,{children:a});export{Z as default};
